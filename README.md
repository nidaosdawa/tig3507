```markdown
# 🧪 MSPM0 旋转编码器综合实验

基于 **TI MSPM0** 的嵌入式人机交互 Demo，整合 **旋转编码器 + RGB 彩灯 + OLED 显示 + 按键状态机**，可直接用于课程设计或实验报告。

---

## ✨ 项目亮点
- ✅ **QEI 定时器** 测向 / 测周期 / 测相位差，误差 < 1 ms  
- ✅ **OLED** 显示中英文姓名、学号及实时旋转参数  
- ✅ **RGB LED** 三色独立调光，步进 ±10 %，无闪烁  
- ✅ **状态机 + 超时** 完成设置模式 & 自动退出  
- ✅ **蜂鸣器反馈** 短按短音 / 进入退出长音  
- ✅ **按键消抖** 20 ms，防止误触发  

---

## 🧰 硬件清单
| 模块 | 引脚连接（杜邦线） |
|------|--------------------|
| **RGB LED** | PA8→PB22(红) / PB20→PB27(绿) / PB0→PB26(蓝) |
| **EC11 编码器** | PB6←→A 相 / PB7←→B 相 / PA18←→K 按键 |
| **OLED** | PA31(SCL) / PA28(SDA) *GPIO 模拟 I²C* |
| **蜂鸣器** | PB23（JP7 跳线帽使能） |
| **运行指示灯** | PA0 低电平点亮 |

---

## 🚀 快速开始
1. **克隆仓库**
   ```bash
   git clone https://github.com/YOU_NAME/MSPM0-EC11-RGB-OLED.git
   cd MSPM0-EC11-RGB-OLED
   ```

2. **打开工程**  
   使用 **TI Code Composer Studio (CCS)** 导入根目录下 `.project` 文件。

3. **编译 & 下载**  
   - 连接 MSPM0 LaunchPad  
   - 点击 **Build** → **Download** 自动烧录

4. **上电运行**  
   - OLED 显示姓名 + 学号 → 进入主界面  
   - 旋转编码器：实时方向 / 周期 / 相位差  
   - **长按 3 s** 进入 RGB 设置 → **R→G→B** 循环 → **5 s 无旋转自动退出**

---

## 📂 代码结构
```
├── main.c              // 主循环 & 状态机
├── keyTask.c/h         // 按键消抖 + 长短按检测
├── updateQEI.c/h       // QEI 周期 / 方向 / 相位计算
├── rgbControl.c/h      // PWM 占空比更新
├── OLED13.c/h          // GPIO 模拟 I²C 驱动
├── beep.c/h            // 蜂鸣器长 / 短音
└── font.c              // 16×16 中文点阵（姓名）
```

---

## 🎛️ 可调参数（宏）
| 宏 | 默认值 | 含义 |
|----|--------|------|
| `KEY_LONG_MS` | 3000U | 长按进入设置阈值 |
| `SET_TIMEOUT_MS` | 5000U | 无旋转自动退出 |
| `KEY_DEBOUNCE_MS` | 20U | 按键消抖时间 |
| `RGB_STEP` | 10 | 旋转步进 ±10 % |

---

## 🧪 实验现象
1. **启动**：OLED 第一行中文姓名，第二行英文，第三行学号 → 2 s 后跳入 **EC11 QEI Meter** 主界面。
2. **旋转**：显示  
   **CLOCKWISE / ANTICLOCKWISE**  
   **Period: xx ms**  
   **Phase: ±x.x ms**  
   **Count: ±n**
3. **长按 3 s**：蜂鸣器 **长音** → 进入设置，默认红灯 50 %。
4. **调节**：顺时针 +10 % 更亮，逆时针 −10 % 更暗。
5. **短按**：R→G→B→Save，每一步 **短音** 反馈。
6. **超时 5 s**：自动退出，恢复红灯 50 %，显示 **Canceled!**。
7. **正常完成**：显示 **Saved!** 并 **长音** 提示。

---

## ⚠️ 已知问题 & 解决
| 现象 | 根因 | 修复方案 |
|------|------|----------|
| OLED 卡死 | GPIO 模拟 I²C 被中断打断 | 关闭 OLED 引脚中断 |
| 按键跳色 | 无消抖 | 添加 20 ms 防抖 |
| 快速旋转卡顿 | I²C 速率低 (~50 kHz) | **后续改用硬件 I²C 400 kHz** |

---

## 🛠️ 后续改进
- [ ] 硬件 I²C 驱动 OLED，刷新提速 8×  
- [ ] EEPROM 保存用户颜色设置  
- [ ] 串口 CLI 实时查看参数  
- [ ] 低功耗休眠 + 唤醒  

---

## 📄 许可证
MIT License — 可自由修改、商用，请保留原作者信息。

---

## 👏 致谢
基于 **TI MSPM0-SDK** 与 **SH1106 OLED** 官方驱动移植，感谢 TI 与开源社区支持。
```
